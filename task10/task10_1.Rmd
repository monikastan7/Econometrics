---
title: "Task10_1"
author: "Monika Stanislovėnaitė, EKO"
date: "2016-04-19"
output: html_document
---
---
[@Hyndman2014a, ch. 3., Lab Session 3]

**Lab Session 3, užduotis nr. 1**  
For this exercise, use the price of a dozen eggs in the United States from 1900–1993 (data set eggs). Experiment with the various options in the `holt()` function to see how much the forecasts change with damped or exponential trend. Also try changing the parameter values for alpha and beta to see how they affect the forecasts. Try to develop an intuition of what each parameter and argument is doing to the forecasts.  
[Hint: use h=100 when calling `holt()` so you can clearly see the differences between the various options when plotting the forecasts.]  
Which model gives the best RMSE?  
Do the residuals from the best model look like white noise?  
  
  
Užduočiai reikės paketo **fpp**:
```{r}
library(fpp)
```

Duomenys:
```{r}
duom <- eggs
```

Pažiūrime, kaip atrodo duomenys:
```{r}
plot(duom)
acf(duom)
```
  
Iš grafiko matome, kad duomenys turi trendą mažėti. ACF lėtai mažėja - tai irgi išduoda trendo buvimą.  

Keli `holt()` variantai:
```{r}
fit1 <- holt(duom, h=100)
plot(fit1, plot.conf=FALSE)
lines(fitted(fit1), col="blue")
s1 <- fit1$model  #alpha=0.8469, beta=0.0001

fit2 <- holt(duom, h=100, exponential=TRUE)
plot(fit2, plot.conf=FALSE)
lines(fitted(fit2), col="red")
s2 <- fit2$model #alpha=0.8218, beta=0.0001

fit3 <- holt(duom, h=100, damped=TRUE)
plot(fit3, plot.conf=FALSE)
lines(fitted(fit3), col="brown")
s3 <- fit3$model #alpha=0.8248, beta=0.0018, phi=0.9683
```
Matome, kad visuose variantuose beta yra labai maži, o alpha yra apie 0.82.  
  
Išbandysime variantą, kur alpha ir beta reikšmės yra visai kitokios. alpha sumažinsine, o beta padidinsime:
```{r}
fit4 <- holt(duom, h=100, alpha=0.2, beta=0.2)
plot(fit4, plot.conf=FALSE)
lines(fitted(fit4), col=7)
```
  
Matome, kad prognozuojamos reikšmės "pastatėjo", geltona linija nebe taip gerai atitinka duomenis. Galime daryti išvadą, kad kuo alpha mažesnis, tuo mažiau prognozė atitinka duomenis, mažiau suglodinama. Kai beta mažesnis, prognozės nuolydis mažesnis.  
  
Palyginsime visas prognozes:
```{r}
plot(duom, xlim=c(1900,2090), ylim=c(-50,400))
lines(fit1$mean, col=3)
lines(fit2$mean, col=2)
lines(fit3$mean, col=4)
lines(fit4$mean, col=5)
legend("topright",lty=1,lwd="1",col=c(3,2,4,5),legend=c("Holt metodas","Holt metodas su ekspon. trendu","Damped Holt metodas","Holt metodas, kai alpha=beta=0.2"))
```

Pažiūrėsime, kuris modelis duoda geriausią *RMSE*:
```{r}
accuracy(fit1)[2]
accuracy(fit2)[2]
accuracy(fit3)[2]
accuracy(fit4)[2]
```
Geriausią (mažiausią) RMSE turi **fit1**, t.y. paprastas Holt metodas.
  
Pažiūrėsime, ar fit1 liekanos atrodo kaip baltasis triukšmas:
```{r}
Acf(fit1$res)
Box.test(fit1$res, fitdf=0, type="Lj")
```
  
Iš ACF matome, kad liekanos yra baltasis triukšmas, nes praktiškai visos linijos neišeina už kritinių reikšmių ribų. `Box.test()` taip pat tai patvirtina, nes p-value>0.05
