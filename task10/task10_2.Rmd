---
title: "Task10_2"
author: "Monika Stanislovėnaitė, EKO"
date: "2016-04-19"
output: html_document
---
---
[@Hyndman2014a, ch. 3., Lab Session 3]

**Lab Session 3, užduotis nr. 2**    
For this exercise, use the monthly Australian short-term overseas visitors data, May 1985–April 2005. (Data set: visitors.)  
(a) Make a time plot of your data and describe the main features of the series.  
(b) Forecast the next two years using Holt-Winters’ multiplicative method.  
(c) Why is multiplicative seasonality necessary here?  
(d) Experiment with making the trend exponential and/or damped.  
(e) Compare the RMSE of the one-step forecasts from the various methods. Which do you prefer?  
(f) Check that the residuals from the best model look like white noise.  

Užduočiai reikės paketo **fpp**:
```{r}
library(fpp)
```

Duomenys:
```{r}
vis <- visitors
```

**(a)** Make a time plot of your data and describe the main features of the series:
```{r}
plot(vis)
```
  
Iš grafiko matome, kad duomenys turi trendą didėti, taip pat yra sezoniškumas. Dar galime įžvelgi, kad trendas turi tendenciją po truputį gęsti.

Kad tikrai yra sezoniškumas, galime įsitikinti ir iš ACF - "pikai" ties lagais 1, 12, 24, ..., t.y kasmet:
```{r}
Acf(vis)
```

**(b)** Forecast the next two years using Holt-Winters’ multiplicative method:
```{r}
fit1 <- hw(vis, h=24, seasonal="mult")
plot(fit1, plot.conf=FALSE)
lines(fitted(fit1), col=2)
```

**(c)** Why is multiplicative seasonality necessary here?  
Reikalingas multiplikatyvus sezoniškumas, nes čia naudingiau matuoti ne absoliučius skirtumus, o proporcijas. Iš grafiko matome, kad bėgant metams "bangos" duomenyse tampa vis ilgesnės, t.y didėja svyravimai. Labiau tikėtina yra tai, kad, pavyzdžiui, kiekvienais metais liepos mėnesio reikšmė yra kažkokia proporcija didesnė už sausio mėnesio reikšmę, negu kad skirtumas tarp jų visuomet yra konstanta.  

**(d)** Experiment with making the trend exponential and damped:
```{r}
fit2 <- hw(vis, h=24, seasonal="mult", exponential=TRUE)
plot(fit2, plot.conf=FALSE)
lines(fitted(fit2), col=2)

fit3 <- hw(vis, h=24, seasonal="mult", damped=TRUE)
plot(fit3, plot.conf=FALSE)
lines(fitted(fit3), col=2)
```
  
Matome, kad kai trendas yra *eksponentinis*, prognozės yra linkusios didėti greičiau. Kai trendas yra *damped* atvirkščiai - prognozės didėja lėčiau ir prognozuojant toliau trendas pamažu turėtų nykti.  
Kad būtų aiškiau ir matytųsi, kaip skiriasi fit1, fit2 ir fit3 prognozės, galime sudėti jas visas į vieną vietą:
```{r}
plot(vis, xlim=c(1985,2007), ylim=c(50,650))
lines(fit1$mean, col=3, lwd=2)
lines(fit2$mean, col=2)
lines(fit3$mean, col=4)
legend("topleft", lty=1, cex=0.8, lwd="1", col=c(3,2,4), legend=c("Holt-Winters' multiplikatyvus metodas","Holt-Winters' mult. metodas su ekspon. trendu","Damped Holt-Winters' mult. metodas"))
```

**(e)** Compare the RMSE of the one-step forecasts from the various methods. Which do you prefer? 
```{r}
accuracy(fit1)[2]
accuracy(fit2)[2]
accuracy(fit3)[2]
```
Kaip ir buvo galima tikėtis, geriausią RMSE turi **fit3**, t.y. prognozės, kai trendas yra *damped*. Jau iš duomenų grafiko matėme, kad trendas turi tendenciją gęsti, todėl ir Holt-Winters metodas, kai trendas *damped* čia labiausiai tinka.

**(f)** Check that the residuals from the best model look like white noise:
```{r}
Acf(fit3$res)
Box.test(fit3$res, fitdf=0, type="Lj")
```
Iš ACF matome, kad liekanos yra baltasis triukšmas, nes praktiškai visos linijos neišeina už kritinių reikšmių ribų. `Box.test()` taip pat tai patvirtina, nes p-value>0.05.  


Naudinga informacija: http://www.simafore.com/blog/bid/205420/Time-series-forecasting-understanding-trend-and-seasonality 
